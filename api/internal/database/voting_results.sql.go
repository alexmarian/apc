// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.28.0
// source: voting_results.sql

package database

import (
	"context"
)

const createVotingResults = `-- name: CreateVotingResults :one
INSERT INTO voting_results (
    gathering_id,
    results_data,
    voting_mode,
    gathering_type,
    total_possible_votes_weight,
    total_possible_votes_count,
    quorum_threshold_percentage,
    quorum_met
)
VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING id, gathering_id, results_data, voting_mode, gathering_type, total_possible_votes_weight, total_possible_votes_count, quorum_threshold_percentage, quorum_met, computed_at
`

type CreateVotingResultsParams struct {
	GatheringID               int64
	ResultsData               string
	VotingMode                string
	GatheringType             string
	TotalPossibleVotesWeight  float64
	TotalPossibleVotesCount   int64
	QuorumThresholdPercentage float64
	QuorumMet                 bool
}

func (q *Queries) CreateVotingResults(ctx context.Context, arg CreateVotingResultsParams) (VotingResult, error) {
	row := q.db.QueryRowContext(ctx, createVotingResults,
		arg.GatheringID,
		arg.ResultsData,
		arg.VotingMode,
		arg.GatheringType,
		arg.TotalPossibleVotesWeight,
		arg.TotalPossibleVotesCount,
		arg.QuorumThresholdPercentage,
		arg.QuorumMet,
	)
	var i VotingResult
	err := row.Scan(
		&i.ID,
		&i.GatheringID,
		&i.ResultsData,
		&i.VotingMode,
		&i.GatheringType,
		&i.TotalPossibleVotesWeight,
		&i.TotalPossibleVotesCount,
		&i.QuorumThresholdPercentage,
		&i.QuorumMet,
		&i.ComputedAt,
	)
	return i, err
}

const deleteVotingResults = `-- name: DeleteVotingResults :exec
DELETE FROM voting_results
WHERE gathering_id = ?
`

func (q *Queries) DeleteVotingResults(ctx context.Context, gatheringID int64) error {
	_, err := q.db.ExecContext(ctx, deleteVotingResults, gatheringID)
	return err
}

const getVotingResults = `-- name: GetVotingResults :one
SELECT id, gathering_id, results_data, voting_mode, gathering_type, total_possible_votes_weight, total_possible_votes_count, quorum_threshold_percentage, quorum_met, computed_at FROM voting_results
WHERE gathering_id = ?
`

func (q *Queries) GetVotingResults(ctx context.Context, gatheringID int64) (VotingResult, error) {
	row := q.db.QueryRowContext(ctx, getVotingResults, gatheringID)
	var i VotingResult
	err := row.Scan(
		&i.ID,
		&i.GatheringID,
		&i.ResultsData,
		&i.VotingMode,
		&i.GatheringType,
		&i.TotalPossibleVotesWeight,
		&i.TotalPossibleVotesCount,
		&i.QuorumThresholdPercentage,
		&i.QuorumMet,
		&i.ComputedAt,
	)
	return i, err
}

const updateVotingResults = `-- name: UpdateVotingResults :one
UPDATE voting_results
SET results_data = ?,
    voting_mode = ?,
    gathering_type = ?,
    total_possible_votes_weight = ?,
    total_possible_votes_count = ?,
    quorum_threshold_percentage = ?,
    quorum_met = ?,
    computed_at = CURRENT_TIMESTAMP
WHERE gathering_id = ? RETURNING id, gathering_id, results_data, voting_mode, gathering_type, total_possible_votes_weight, total_possible_votes_count, quorum_threshold_percentage, quorum_met, computed_at
`

type UpdateVotingResultsParams struct {
	ResultsData               string
	VotingMode                string
	GatheringType             string
	TotalPossibleVotesWeight  float64
	TotalPossibleVotesCount   int64
	QuorumThresholdPercentage float64
	QuorumMet                 bool
	GatheringID               int64
}

func (q *Queries) UpdateVotingResults(ctx context.Context, arg UpdateVotingResultsParams) (VotingResult, error) {
	row := q.db.QueryRowContext(ctx, updateVotingResults,
		arg.ResultsData,
		arg.VotingMode,
		arg.GatheringType,
		arg.TotalPossibleVotesWeight,
		arg.TotalPossibleVotesCount,
		arg.QuorumThresholdPercentage,
		arg.QuorumMet,
		arg.GatheringID,
	)
	var i VotingResult
	err := row.Scan(
		&i.ID,
		&i.GatheringID,
		&i.ResultsData,
		&i.VotingMode,
		&i.GatheringType,
		&i.TotalPossibleVotesWeight,
		&i.TotalPossibleVotesCount,
		&i.QuorumThresholdPercentage,
		&i.QuorumMet,
		&i.ComputedAt,
	)
	return i, err
}
